//tealium universal tag - utag.105 ut4.0.202008061512, Copyright 2020 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1};u.initialized=false;u.map={"product_is_marketplace":"product_is_marketplace","product_is_giftcard":"product_is_giftcard"};u.extend=[function(a,b){try{if(b['customer_auth_state'].toString().toLowerCase()=='AUTHORIZED'.toLowerCase()){b['remark_status']='EXISTING'}}catch(e){utag.DB(e);}},function(a,b){try{if(b['customer_auth_state'].toString().toLowerCase()=='GUEST'.toLowerCase()){b['remark_status']='NEW'}}catch(e){utag.DB(e);}},function(a,b,c,d,e,f,g){if(1){d=b['cp.urbn_language'];if(typeof d=='undefined')return;c=[{'en-GB':'37257'},{'fr-FR':'39725'},{'de-DE':'43764'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['rakuten_mid']=c[e][f];m=true};};if(m)break};if(!m)b['rakuten_mid']='39789';}},function(a,b,c,d,e,f,g){if(1){d=b['cp.urbn_language'];if(typeof d=='undefined')return;c=[{'en-GB':'115394'},{'fr-FR':'115859'},{'de-DE':'117359'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['rakuten_cadence']=c[e][f];m=true};};if(m)break};if(!m)b['rakuten_cadence']='115251';}},function(a,b,c,d,e,f,g){if(1){d=b['cp.urbn_language'];if(typeof d=='undefined')return;c=[{'en-GB':'20'},{'fr-FR':'20'},{'de-DE':'19'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['rakuten_tax_rate']=c[e][f];m=true};};if(m)break};if(!m)b['rakuten_tax_rate']='0';}},function(a,b){try{if((typeof b['qp.registryId']!='undefined'&&typeof b['qp.createComplete']!='undefined'&&typeof b['qp.registryId']!='undefined'&&b['qp.registryId']!=''&&typeof b['qp.createComplete']!='undefined'&&b['qp.createComplete']!=''&&b['qp.createComplete']=='true')){b['order_id']=b['qp.registryId'];b['order_currency']='USD';b['remark_status']='';b['order_discount_amount']='0';b['order_promo_code']='';b['order_tax_amount']='0';b['product_sku']='Registry'}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['product_default_category']!='undefined'&&typeof b['product_default_category']!='undefined'&&b['product_default_category']!='')){b['product_category']=b['product_default_category']}}catch(e){utag.DB(e);}},function(a,b){try{if(typeof b['product_category']!='undefined'){for(var i=0;i<b.product_category.length;i++){b.product_category[i]=b.product_category[i].replace(/,/g,'>');}}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(1){d=b['product_is_marketplace'];if(typeof d=='undefined')return;c=[{'1':'Y'},{'0':'N'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['product_is_marketplace']=c[e][f];m=true};};if(m)break};}},function(a,b,c,d,e,f,g){if(1){d=b['product_is_giftcard'];if(typeof d=='undefined')return;c=[{'1':'true'},{'0':'false'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['product_is_giftcard']=c[e][f];m=true};};if(m)break};}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={"product_is_marketplace":"","product_is_giftcard":""};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){if(typeof utag_err!='undefined'){utag_err.push({e:'extension error:'+e,s:utag.cfg.path+'utag.'+id+'.js',l:c,t:'ex'})}}};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
(function(url){if(!window.DataLayer){window.DataLayer={};}
if(!DataLayer.events){DataLayer.events={};}
DataLayer.events.SiteSection="1";var loc,ct=document.createElement("script");ct.type="text/javascript";ct.async=true;ct.src=url;loc=document.getElementsByTagName('script')[0];loc.parentNode.insertBefore(ct,loc);}(document.location.protocol+"//intljs.rmtag.com/"+b.rakuten_cadence+".ct.js"));if(b.order_id){var rakitems=[];if(b.product_sku==="Registry"){rakitems.push({quantity:1,unitPrice:0,unitPriceLessTax:0,SKU:'Registry',productName:'Registry',});}else if(b.product_sku){for(var i=0;i<b.product_sku.length;i++){if(b.product_is_marketplace[i]==0){b.product_is_marketplace[i]="N"}
else if(b.product_is_marketplace[i]==1){b.product_is_marketplace[i]="Y"}
if(b.product_is_giftcard[i]==0){b.product_is_giftcard[i]="false"}
else if(b.product_is_giftcard[i]==1){b.product_is_giftcard[i]="true"}
rakitems.push({quantity:b.product_quantity[i],unitPrice:b.product_selling_price[i],unitPriceLessTax:b.product_selling_price[i],SKU:b.product_sku[i],productName:b.product_name[i],optionalData:{cat:b.product_category[i],coupon:b.product_promo_code[i],brand:b.product_brand[i]}});}}
var rm_trans={affiliateConfig:{ranMID:b.rakuten_mid,discountType:'item',includeStatus:'true',taxRate:b.rakuten_tax_rate,removeTaxFromDiscount:true},optionalData:{coupon:b.order_promo_code,custstatus:b.remark_status,ismarketplace:b.product_is_marketplace[0],isgiftcard:b.product_is_giftcard[0]},orderid:b.order_id,currency:b.order_currency,customerStatus:b.remark_status,conversionType:'Sale',customerID:b.customer_id,discountAmount:b.order_discount_amount,taxAmount:b.order_tax_amount,lineitems:rakitems};if(!window.DataLayer){window.DataLayer={Sale:{Basket:rm_trans}}}else{DataLayer.Sale=DataLayer.Sale||{Basket:rm_trans};DataLayer.Sale.Basket=DataLayer.Sale.Basket||rm_trans}DataLayer.Sale.Basket.Ready=true;function __readRMCookie(e){for(var a=e+"=",t=document.cookie.split(";"),r=0;r<t.length;r++){for(var n=t[r];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(a))return n.substring(a.length,n.length)}return""}function __readRMCookiev2(e,a){for(var t=__readRMCookie(a=a||"rmStore");t!==decodeURIComponent(t);)t=decodeURIComponent(t);for(var r=t.split("|"),n=0;n<r.length;n++){var i=r[n].split(":")[0],o=r[n].split(":")[1];if(i===e)return o}return""}function __readParam(e,a,t,r){var n=a||"",i=t||"",o=r||{},s=__readRMCookiev2(e||""),u=o[n],d=(s=o.ignoreCookie||!1?0:s)||u||i;return d=("string"!=typeof d||"false"!==d.toLowerCase())&&d}function sRAN(){var e=DataLayer&&DataLayer.Sale&&DataLayer.Sale.Basket?DataLayer.Sale.Basket:{},a=e.affiliateConfig||{},t=__readParam("atm","tagType","pixel",a),r=__readParam("adr","discountType","order",a),n=__readParam("acs","includeStatus","false",a),i=__readParam("arto","removeOrderTax","false",a),o=__readParam("artp","removeTaxFromProducts","false",a),s=__readParam("artd","removeTaxFromDiscount","false",a),u=__readParam("atr","taxRate",0,a);u=Number(u);var d=__readParam("ald","land",!1,{})||(a.land&&!0===a.land?__readRMCookie("ranLandDateTime"):a.land)||!1,m=__readParam("atrv","tr",!1,{})||(a.tr&&!0===a.tr?__readRMCookie("ranSiteID"):a.tr)||!1,l=!1,c=__readParam("amid","ranMID","",a)||e.ranMID;if(!c)return!1;if(!(void 0===a.allowCommission||"false"!==a.allowCommission))return!1;var p=e.orderid||"OrderNumberNotAvailable",y="",f="",v="",N="",_=e.currency||"";_=_.toUpperCase();var h=e.taxAmount?Math.abs(Math.round(100*Number(e.taxAmount))):0,b=e.discountAmount?Math.abs(Math.round(100*Number(e.discountAmount))):0;if(s&&u){var g=(100+Number(u))/100;b=Math.round(b/g)}var C="pixel"===t?"ep":"mop"===t?"eventnvppixel":"ep",P=e.customerStatus||"",x=document.location.protocol+"//track.linksynergy.com/"+C+"?",D="";null!=P&&""!=P&&(n&&"EXISTING"==P.toUpperCase()||n&&"RETURNING"==P.toUpperCase())&&(D="R_");for(var S=[],w=0,T=0;T<(e.lineitems?e.lineitems.length:0);T++){for(var L=!1,R=window.JSON?JSON.parse(JSON.stringify(e.lineitems[T])):e.lineitems[T],I=0;I<S.length;I++){S[I].SKU===R.SKU&&(L=!0,S[I].quantity=Number(S[I].quantity)+Number(R.quantity),S[I].totalValueLessTax=Number(S[I].totalValueLessTax)+Number(R.quantity)*Number(R.unitPriceLessTax),S[I].totalValue=Number(S[I].totalValue)+Number(R.quantity)*Number(R.unitPrice))}L||(R.totalValue=Number(R.quantity)*Number(R.unitPrice),R.totalValueLessTax=Number(R.quantity)*Number(R.unitPriceLessTax),S.push(R)),w+=Number(R.quantity)*Number(R.unitPriceLessTax||R.unitPrice)*100}var k={};for(T=0;T<S.length;T++){R=S[T];var M=encodeURIComponent(R.SKU),U=R.totalValueLessTax||R.totalValue,O=R.quantity,A=encodeURIComponent(R.productName)||"",q=Math.round(100*Number(U));if(o&&u&&(!R.unitPriceLessTax||R.unitPriceLessTax===R.unitPrice))q/=g=(100+u)/100;"item"===r.toLowerCase()&&b&&(q-=b*q/w);var E=R.optionalData;for(var B in E)E.hasOwnProperty(B)&&(k[B]=k[B]||"",k[B]+=encodeURIComponent(E[B])+"|");y+=D+M+"|",f+=O+"|",v+=Math.round(q)+"|",N+=D+A+"|"}y=y.slice(0,-1),f=f.slice(0,-1),v=v.slice(0,-1),N=N.slice(0,-1),b&&"order"===r.toLowerCase()?(y+="|"+D+"DISCOUNT",N+="|"+D+"DISCOUNT",f+="|0",v+="|-"+b):b&&"item"===r.toLowerCase()&&(l=!0),i&&h&&(y+="|"+D+"ORDERTAX",f+="|0",v+="|-"+h,N+="|"+D+"ORDERTAX"),x+="mid="+c+"&ord="+p+"&skulist="+y+"&qlist="+f+"&amtlist="+v+"&cur="+_+"&namelist="+N+"&img=1&",d&&(x+="land="+d+"&"),m&&(x+="tr="+m+"&"),l&&(x+="discount="+b+"&");E=e.optionalData||{};for(var B in E)E.hasOwnProperty(B)&&(x+=B+"="+encodeURIComponent(E[B])+"&");for(var B in k)k.hasOwnProperty(B)&&(x+=B+"list="+k[B].slice(0,-1)+"&");"&"===x[x.length-1]&&(x=x.slice(0,-1)),x.length>2037&&(x=x.slice(0,2037),x+="&trunc=true");var V,j=document.createElement("img");j.setAttribute("src",x),j.setAttribute("height","1px"),j.setAttribute("width","1px"),(V=document.getElementsByTagName("script")[0]).parentNode.insertBefore(j,V)}function sDisplay(){var e=null,a=e,t=e,r=e,n=e,i=window.DataLayer&&window.DataLayer.Sale&&window.DataLayer.Sale.Basket?window.DataLayer.Sale.Basket:{},o=i.displayConfig||{},s=i.customerStatus||"",u=i.discountAmount?Math.abs(Number(i.discountAmount)):0,d=e,m=__readParam("dmid","rdMID","",o);if(!m)return!1;var l=__readParam("dtm","tagType","js",o),c="if"===(l="js"===l||"if"===l||"img"===l?l:"js")?"iframe":"img"===l?l:"script",p="//"+__readParam("ddn","domain","tags.rd.linksynergy.com",o)+"/"+l+"/"+m,y=__readParam("dis","includeStatus","false",o),f="";if(null!=s&&""!=s&&(y&&"EXISTING"==s.toUpperCase()||y&&"RETURNING"==s.toUpperCase())&&(f="R_"),!i.orderid||!i.conversionType)return!1;r=0,t=f+i.orderid,a="",n="conv",d=i.currency;for(var v=0;v<(i.lineitems?i.lineitems.length:0);v++)r+=Number(i.lineitems[v].unitPriceLessTax)*Number(i.lineitems[v].quantity)||Number(i.lineitems[v].unitPrice)*Number(i.lineitems[v].quantity),a+=encodeURIComponent(i.lineitems[v].SKU)+",";r=Math.round(100*(r-u))/100,(a=a.slice(0,-1))&&(p=p.indexOf("?")>-1?p+"&prodID="+a:p+"/?prodID="+a),t&&(p=p.indexOf("?")>-1?p+"&orderNumber="+t:p+"/?orderNumber="+t),r&&(p=p.indexOf("?")>-1?p+"&price="+r:p+"/?price="+r),d&&(p=p.indexOf("?")>-1?p+"&cur="+d:p+"/?cur="+d),n&&(p=p.indexOf("?")>-1?p+"&pt="+n:p+"/?pt="+n);var N=document.createElement(c);N.src=p,"script"===c?N.type="text/javascript":"iframe"===c&&N.setAttribute("style","display: none;"),document.getElementsByTagName("body")[0].appendChild(N)}function sSearch(){var e=window.DataLayer&&window.DataLayer.Sale&&window.DataLayer.Sale.Basket?window.DataLayer.Sale.Basket:{},a=e.searchConfig||{},t=__readParam("smid","rsMID","",a);if(!t)return!1;var r=function(){var r=e.discountAmount?Math.abs(Number(e.discountAmount)):0,n=__readParam("sct","conversionType","conv",a),i=0,o="";if(!e.orderid)return!1;i=0,o=e.orderid;for(var s=0;s<(e.lineitems?e.lineitems.length:0);s++)i+=Number(e.lineitems[s].unitPrice)*Number(e.lineitems[s].quantity);i=Math.round(100*(i-r))/100;window.DataLayer.Sale.Basket;var u=[];u[0]="id="+t,u[1]="type="+n,u[2]="val="+i,u[3]="orderId="+o,u[4]="promoCode="+e.discountCode||"",u[5]="valueCurrency="+e.currency||"USD",u[6]="GCID=",u[7]="kw=",u[8]="product=",k_trackevent(u,"113")},n=document.location.protocol.indexOf("s")>-1?"https://":"http://";n+="113.xg4ken.com/media/getpx.php?cid="+t;var i=document.createElement("script");i.type="text/javascript",i.src=n,i.onload=r,i.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||r()},document.getElementsByTagName("head")[0].appendChild(i)}sRAN(),sDisplay(),sSearch();}
}};utag.o[loader].loader.LOAD(id);})("105","urbanoutfitters.a15-urbnweb");}catch(error){utag.DB(error);}
